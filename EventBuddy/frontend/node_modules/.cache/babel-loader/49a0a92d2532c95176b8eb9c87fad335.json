{"remainingRequest":"C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\src\\views\\ProfileEditor.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\src\\views\\ProfileEditor.vue","mtime":1582061164000},{"path":"C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkM6XFxVc2Vyc1xcUGFyaWRlXFxEZXNrdG9wXFxQcm9nZXR0byBGaW5hbGVcXEV2ZW50QnVkZHlcXGZyb250ZW5kXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgYXBpU2VydmljZSB9IGZyb20gIi4uL2NvbW1vbi9hcGkuc2VydmljZSI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyI7CmltcG9ydCB7IENTUkZfVE9LRU4gfSBmcm9tICIuLi9jb21tb24vY3NyZl90b2tlbi5qcyI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUHJvZmlsZUVkaXRvciIsCiAgcHJvcHM6IHsKICAgIHVzZXJVc2VybmFtZTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9LAogICAgcHJldmlvdXNQcm9maWxlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgcmVxdWlyZWQ6IGZhbHNlCiAgICB9CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgLy8gIHByb2ZpbGVfYXZhdGFyOiB0aGlzLnByZXZpb3VzUHJvZmlsZSB8fCBudWxsLAogICAgICBwcm9maWxlX2JpbzogdGhpcy5wcmV2aW91c1Byb2ZpbGUgfHwgbnVsbCwKICAgICAgcHJvZmlsZV9sb2NhdGlvbjogdGhpcy5wcmV2aW91c1Byb2ZpbGUgfHwgbnVsbCwKICAgICAgcHJvZmlsZV9iaXJ0aF9kYXRlOiB0aGlzLnByZXZpb3VzUHJvZmlsZSB8fCBudWxsLAogICAgICBmaWxlOiBudWxsLAogICAgICBlcnJvcjogbnVsbAogICAgfTsKICB9LAogIC8vdG8gZmlsbCB0aGUgZmllbGRzIGF0IG9uUGFnZUxvYWQ/PwogIGJlZm9yZVJvdXRlRW50ZXI6IGZ1bmN0aW9uIGJlZm9yZVJvdXRlRW50ZXIodG8sIGZyb20sIG5leHQpIHsKICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvcigKICAgIC8qI19fUFVSRV9fKi8KICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgIHZhciBlbmRwb2ludDsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIGlmICghKHRvLnBhcmFtcy51c2VyVXNlcm5hbWUgIT09IHVuZGVmaW5lZCkpIHsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBlbmRwb2ludCA9ICIvYXBpL3Byb2ZpbGVzLyIuY29uY2F0KHRvLnBhcmFtcy51c2VyVXNlcm5hbWUsICIvIik7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgcmV0dXJuIGFwaVNlcnZpY2UoZW5kcG9pbnQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgIHRvLnBhcmFtcy5wcmV2aW91c1Byb2ZpbGUgPSBkYXRhLmNvbnRlbnQ7CiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgbmV4dCgpKTsKCiAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgX2NhbGxlZSk7CiAgICB9KSkoKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8qDQogICAgICAgIEhhbmRsZXMgYSBjaGFuZ2Ugb24gdGhlIGZpbGUgdXBsb2FkDQogICAgICAqLwogICAgaGFuZGxlRmlsZVVwbG9hZDogZnVuY3Rpb24gaGFuZGxlRmlsZVVwbG9hZCgpIHsKICAgICAgdGhpcy5maWxlID0gdGhpcy4kcmVmcy5maWxlLmZpbGVzWzBdOwogICAgICBjb25zb2xlLmxvZyh0aGlzLmZpbGUubmFtZSk7CiAgICB9LAogICAgc3VibWl0RmlsZTogZnVuY3Rpb24gc3VibWl0RmlsZSgpIHsKICAgICAgLyoNCiAgICAgICAgICAgICAgICBJbml0aWFsaXplIHRoZSBmb3JtIGRhdGENCiAgICAgICAgICAgICovCiAgICAgIHZhciBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAvKg0KICAgICAgICAgICAgICAgIEFkZCB0aGUgZm9ybSBkYXRhIHdlIG5lZWQgdG8gc3VibWl0DQogICAgICAgICAgICAqLwoKICAgICAgZm9ybURhdGEuYXBwZW5kKCJmaWxlIiwgdGhpcy5maWxlKTsKICAgICAgLyoNCiAgICAgICAgICBNYWtlIHRoZSByZXF1ZXN0IHRvIHRoZSBQT1NUIGBhcGkvcHJvZmlsZXMvJHt0aGlzLnVzZXJVc2VybmFtZX0vYXZhdGFyL2AgVVJMICANCiAgICAgICAgKi8KCiAgICAgIGF4aW9zLnB1dCgiaHR0cDovLzEyNy4wLjAuMTo4MDAwL2FwaS9wcm9maWxlcy8iLmNvbmNhdCh0aGlzLnVzZXJVc2VybmFtZSwgIi9hdmF0YXIvIiksIGZvcm1EYXRhLCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJtdWx0aXBhcnQvZm9ybS1kYXRhIiwKICAgICAgICAgICJYLUNTUkZUb2tlbiI6IENTUkZfVE9LRU4KICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIGNvbnNvbGUubG9nKCJTVUNDRVNTISEiKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgICAgIGNvbnNvbGUubG9nKCJGQUlMVVJFISEiKTsKICAgICAgfSk7CiAgICB9LAogICAgb25TdWJtaXQ6IGZ1bmN0aW9uIG9uU3VibWl0KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9wcm9maWxlX2F2YXRhcgogICAgICAvL1BPU1QgaW4gdGhlIEFQSS9wcm9maWxlcy8KICAgICAgdmFyIGVuZHBvaW50ID0gIi9hcGkvcHJvZmlsZXMvIi5jb25jYXQodGhpcy51c2VyVXNlcm5hbWUsICIvIik7CiAgICAgIHZhciBtZXRob2QgPSAiUFVUIjsgLy9pZiAodGhpcy5wcmV2aW91c1Byb2ZpbGUpIHsKICAgICAgLy8gIG1ldGhvZCA9ICJQVVQiOwogICAgICAvLyAgZW5kcG9pbnQgKz0gYCR7dGhpcy51c2VyVXNlcm5hbWV9L2A7CiAgICAgIC8vfSAvL2NhbGwgdGhlIHNlcnZpY2UgZm9yIHRoZSBQT1NUIHJlcXVlc3QgYW5kIHRoZW4uLgoKICAgICAgYXBpU2VydmljZShlbmRwb2ludCwgbWV0aG9kLCB7CiAgICAgICAgYmlvOiB0aGlzLnByb2ZpbGVfYmlvLAogICAgICAgIGxvY2F0aW9uOiB0aGlzLnByb2ZpbGVfbG9jYXRpb24sCiAgICAgICAgYmlydGhfZGF0ZTogdGhpcy5wcm9maWxlX2JpcnRoX2RhdGUsCiAgICAgICAgYXZhdGFyOiB0aGlzLmZpbGUKICAgICAgfSkudGhlbihmdW5jdGlvbiAocHJvZmlsZV9kYXRhKSB7CiAgICAgICAgLy9yZWRpcmVjdCByb3V0ZXIgdG8gdGhlIGV2ZW50IGRlc2NyaXB0aW9uCiAgICAgICAgX3RoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgIG5hbWU6ICJ1c2VyLXByb2ZpbGUiLAogICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgIHVzZXJVc2VybmFtZTogcHJvZmlsZV9kYXRhLnVzZXIKICAgICAgICAgIH0gLy9ldmVudCBqdXN0ICJQT1NURUQiCgogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICBkb2N1bWVudC50aXRsZSA9ICJFZGl0b3IgLSBFdmVudEJ1ZGR5IjsKICB9Cn07"},{"version":3,"sources":["ProfileEditor.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"container mt-2\">\r\n    <div class=\"row\">\r\n      <div class=\"col-12\">\r\n        <h1 class=\"mb-3\">{{ userUsername }}: Modifica il tuo Profilo</h1>\r\n        <form @submit.prevent=\"onSubmit\">\r\n          <!--@ onSubmit.prevent = prevent the page to reload -->\r\n          <!--Picture Profile-->\r\n\r\n          <textarea\r\n            v-model=\"profile_bio\"\r\n            class=\"form-control\"\r\n            placeholder=\"Biografia\"\r\n            rows=\"4\"\r\n          >\r\n          </textarea>\r\n          <textarea\r\n            v-model=\"profile_location\"\r\n            class=\"form-control\"\r\n            placeholder=\"CittÃ \"\r\n            rows=\"1\"\r\n          >\r\n          </textarea>\r\n          <div class=\"form-row\">\r\n            <div class=\"date-control mt-2 col\">\r\n              <p>Data nascita</p>\r\n              <input\r\n                type=\"date\"\r\n                id=\"profile-birth\"\r\n                name=\"profile-birth\"\r\n                v-model=\"profile_birth_date\"\r\n                value=\"\"\r\n              />\r\n            </div>\r\n\r\n            <!-- btn Upload image-->\r\n\r\n            <div class=\"mt-2 col-sm-4\">\r\n              <div class=\"name\">Immagine Profilo</div>\r\n              <div class=\"btn blue-gradient btn-sm float-left\">\r\n                <input\r\n                  type=\"file\"\r\n                  id=\"file\"\r\n                  ref=\"file\"\r\n                  v-on:change=\"handleFileUpload()\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <br />\r\n          <button\r\n            class=\"btn btn-success\"\r\n            type=\"submit\"\r\n          >\r\n            Aggiorna Profilo\r\n          </button>\r\n        </form>\r\n\r\n        <p class=\"error mt-2\">{{ error }}</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { apiService } from \"../common/api.service\";\r\nimport axios from \"axios\";\r\nimport { CSRF_TOKEN } from \"../common/csrf_token.js\";\r\nexport default {\r\n  name: \"ProfileEditor\",\r\n\r\n  props: {\r\n    userUsername: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    previousProfile: {\r\n      type: String,\r\n      required: false\r\n    }\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      //  profile_avatar: this.previousProfile || null,\r\n      profile_bio: this.previousProfile || null,\r\n      profile_location: this.previousProfile || null,\r\n      profile_birth_date: this.previousProfile || null,\r\n      file: null,\r\n      error: null\r\n    };\r\n  },\r\n  //to fill the fields at onPageLoad??\r\n  async beforeRouteEnter(to, from, next) {\r\n    if (to.params.userUsername !== undefined) {\r\n      let endpoint = `/api/profiles/${to.params.userUsername}/`;\r\n      await apiService(endpoint).then(data => {\r\n        to.params.previousProfile = data.content;\r\n      });\r\n    }\r\n    return next();\r\n  },\r\n\r\n  methods: {\r\n    /*\r\n        Handles a change on the file upload\r\n      */\r\n    handleFileUpload() {\r\n      this.file = this.$refs.file.files[0];\r\n      console.log(this.file.name);\r\n    },\r\n    submitFile() {\r\n      /*\r\n                Initialize the form data\r\n            */\r\n      let formData = new FormData();\r\n\r\n      /*\r\n                Add the form data we need to submit\r\n            */\r\n      formData.append(\"file\", this.file);\r\n\r\n      /*\r\n          Make the request to the POST `api/profiles/${this.userUsername}/avatar/` URL  \r\n        */\r\n      axios\r\n        .put(\r\n          `http://127.0.0.1:8000/api/profiles/${this.userUsername}/avatar/`,\r\n          formData,\r\n          {\r\n            headers: {\r\n              \"Content-Type\": \"multipart/form-data\",\r\n              \"X-CSRFToken\": CSRF_TOKEN\r\n            }\r\n          }\r\n        )\r\n        .then(function() {\r\n          console.log(\"SUCCESS!!\");\r\n        })\r\n        .catch(function() {\r\n          console.log(\"FAILURE!!\");\r\n        });\r\n    },\r\n\r\n    onSubmit() {\r\n      //profile_avatar\r\n      //POST in the API/profiles/\r\n      let endpoint = `/api/profiles/${this.userUsername}/`;\r\n      let method = \"PUT\";\r\n      //if (this.previousProfile) {\r\n      //  method = \"PUT\";\r\n      //  endpoint += `${this.userUsername}/`;\r\n      //} //call the service for the POST request and then..\r\n      apiService(endpoint, method, {\r\n        bio: this.profile_bio,\r\n        location: this.profile_location,\r\n        birth_date: this.profile_birth_date,\r\n        avatar: this.file\r\n      }).then(profile_data => {\r\n        //redirect router to the event description\r\n        this.$router.push({\r\n          name: \"user-profile\",\r\n          params: { userUsername: profile_data.user } //event just \"POSTED\"\r\n        });\r\n      });\r\n    }\r\n  },\r\n\r\n  created() {\r\n    document.title = \"Editor - EventBuddy\";\r\n  }\r\n};\r\n</script>\r\n"],"sourceRoot":"src/views"}]}