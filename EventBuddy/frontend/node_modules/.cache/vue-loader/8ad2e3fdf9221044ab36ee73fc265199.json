{"remainingRequest":"C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\src\\views\\Event.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\src\\views\\Event.vue","mtime":1582053288000},{"path":"C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\Desktop\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGFwaVNlcnZpY2UgfSBmcm9tICIuLi9jb21tb24vYXBpLnNlcnZpY2UiOwppbXBvcnQgbW9tZW50IGZyb20gIm1vbWVudCI7CmltcG9ydCBSZXZpZXdDb21wb25lbnQgZnJvbSAiLi4vY29tcG9uZW50cy9SZXZpZXcudnVlIjsKaW1wb3J0IEV2ZW50QWN0aW9ucyBmcm9tICIuLi9jb21wb25lbnRzL0V2ZW50QWN0aW9ucy52dWUiOyAvL3RvIEVkaXQvRGVsZXRlIEV2ZW50cwppbXBvcnQgUmV2aWV3Rm9ybSBmcm9tICIuLi9jb21wb25lbnRzL1Jldmlld0Zvcm0udnVlIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiRXZlbnQiLAoKICBwcm9wczogewogICAgLy8gdXNlZCBpbiB0aGlzIGNvbXBvbmVudAogICAgLy90byBnZXQgdGhlIHJpZ2h0IEV2ZW50IHdlIG5lZWQgaGlzIHNsdWcKICAgIHNsdWc6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICByZXF1aXJlZDogdHJ1ZQogICAgfQogIH0sCiAgY29tcG9uZW50czogewogICAgLy91c2VkIGluIHRoaXMgY29tcG9uZW50CiAgICBSZXZpZXdDb21wb25lbnQsCiAgICBFdmVudEFjdGlvbnMsCiAgICBSZXZpZXdGb3JtCiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZXZlbnQ6IHt9LAogICAgICBsb2FkaW5nUmV2aWV3czogZmFsc2UsCiAgICAgIHJldmlld3M6IFtdLAogICAgICB1c2VySGFzUmV2aWV3ZWQ6IGZhbHNlLAogICAgICBzaG93Rm9ybTogZmFsc2UsIC8vaWYgdXNlckhhcyBOb3QgUmV2aWV3ZWQgdGhlbiBzaG93Rm9ybQogICAgICByZXF1ZXN0VXNlcjogbnVsbAogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgaXNPd25lcigpIHsKICAgICAgcmV0dXJuIHRoaXMuZXZlbnQuYXV0aG9yID09PSB0aGlzLnJlcXVlc3RVc2VyOwogICAgfQogIH0sCgogIG1ldGhvZHM6IHsKICAgIC8vRXZlbnRzL3NsdWcvCiAgICBnZXRFdmVudERhdGEoKSB7CiAgICAgIGxldCBlbmRwb2ludCA9IGAvYXBpL2V2ZW50cy8ke3RoaXMuc2x1Z30vYDsgLy9lbmRwb2ludAogICAgICBhcGlTZXJ2aWNlKGVuZHBvaW50KS50aGVuKGRhdGEgPT4gewogICAgICAgIHRoaXMuZXZlbnQgPSBkYXRhOwogICAgICAgIHRoaXMudXNlckhhc1Jldmlld2VkID0gZGF0YS51c2VyX2hhc19yZXZpZXdlZDsKICAgICAgICB0aGlzLnNldFBhZ2VUaXRsZShkYXRhLnRpdGxlKTsKICAgICAgfSk7CiAgICB9LAoKICAgIGdldEV2ZW50UmV2aWV3cygpIHsKICAgICAgLy9yZXZpZXdzIG1hZGUgYWJvdXQgdGhlIGV2ZW50CiAgICAgIGxldCBlbmRwb2ludCA9IGAvYXBpL2V2ZW50cy8ke3RoaXMuc2x1Z30vcmV2aWV3cy9gOwogICAgICAvL2lmICh0aGlzLm5leHQpIHsgICAgICAgICAgICAgICAgbG9hZE1vcmVSZXZpZXcgcGFydCBpcyBjb21tZW50ZWQKICAgICAgLy8gIGVuZHBvaW50ID0gdGhpcy5uZXh0OyAgICAgICAgIGxvYWRNb3JlUmV2aWV3IHBhcnQgaXMgY29tbWVudGVkCiAgICAgIC8vfQogICAgICB0aGlzLmxvYWRpbmdSZXZpZXdzID0gdHJ1ZTsKICAgICAgYXBpU2VydmljZShlbmRwb2ludCkudGhlbihkYXRhID0+IHsKICAgICAgICB0aGlzLnJldmlld3MgPSBkYXRhLnJlc3VsdHM7IC8vLnB1c2goLi4uZGF0YS5yZXN1bHRzKTsgIGxvYWRNb3JlUmV2aWV3IHBhcnQgaXMgY29tbWVudGVkCiAgICAgICAgdGhpcy5sb2FkaW5nUmV2aWV3cyA9IGZhbHNlOwogICAgICAgIC8vaWYgKGRhdGEubmV4dCkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9hZE1vcmVSZXZpZXcgcGFydCBpcyBjb21tZW50ZWQKICAgICAgICAvLyAgdGhpcy5uZXh0ID0gZGF0YS5uZXh0OwogICAgICAgIC8vfSBlbHNlIHsKICAgICAgICAvLyAgdGhpcy5uZXh0ID0gbnVsbDsKICAgICAgICAvLyB9CiAgICAgIH0pOwogICAgfSwKCiAgICBhc3luYyBkZWxldGVSZXZpZXcocmV2aWV3KSB7CiAgICAgIC8vREVMRVRFIHRyaWdnZXJlZCBmcm9tIHRoZSBSZXZpZXcgY29tcG9uZW50IGJvdHRvbgogICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9yZXZpZXdzLyR7cmV2aWV3LmlkfS9gOwogICAgICB0cnkgewogICAgICAgIGF3YWl0IGFwaVNlcnZpY2UoZW5kcG9pbnQsICJERUxFVEUiKTsgLy9jb25uZXRjdGluZyB0byB0aGUgQVBJLCBkZWxldGUgZnJvbSBEQgogICAgICAgIHRoaXMuJGRlbGV0ZSh0aGlzLnJldmlld3MsIHRoaXMucmV2aWV3cy5pbmRleE9mKHJldmlldykpOyAvLyBkZWxldGUgZnJvbSB0aGUgYXJyYXkgYW5kIHVwZGF0ZQogICAgICAgIHRoaXMudXNlckhhc1Jldmlld2VkID0gZmFsc2U7CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgIH0KICAgIH0sCiAgICAvL3RvIG91dHB1dCB0aGUgZXZlbnRfZGF0ZSBpbiB0aGUgcmlnaHQgZm9ybWF0LCB3aXRoIGZpbHRlcnMKICAgIG1vbWVudDogZnVuY3Rpb24oZGF0ZSkgewogICAgICByZXR1cm4gbW9tZW50KGRhdGUpLmxvY2FsZSgiaXQiKTsKICAgIH0sCiAgICBzZXRQYWdlVGl0bGUodGl0bGUpIHsKICAgICAgZG9jdW1lbnQudGl0bGUgPSB0aXRsZTsKICAgIH0sCiAgICBzZXRSZXF1ZXN0VXNlcigpIHsKICAgICAgdGhpcy5yZXF1ZXN0VXNlciA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidXNlcm5hbWUiKTsKICAgIH0KICB9LAoKICAvL25vIG1ldGhvZHMKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRFdmVudERhdGEoKTsKICAgIHRoaXMuZ2V0RXZlbnRSZXZpZXdzKCk7CiAgICB0aGlzLnNldFJlcXVlc3RVc2VyKCk7CiAgfQp9Owo="},{"version":3,"sources":["Event.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuFA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Event.vue","sourceRoot":"src/views","sourcesContent":["<!--Single Event: Event details page \"api/event/:slug\", -->\n<!--Review list: List of ReviewComponent if event is expired-->\n<!--Review: Add a Review form  if !Event.userHasReviewed and event is expired -->\n\n<template>\n  <div class=\"single-event\">\n    <div class=\"card \">\n      <!-------------------------------Event details------------------------------------>\n      <!--######<p> {{ event.image }}</p>-->\n      <div class=\"card-header\">\n        <h1>{{ event.title }}</h1>\n        <p>\n          <img\n            :src=\"event.picture\"\n            class=\" .float-left \"\n            style=\"\"\n            alt=\"avatar\"\n          />\n        </p>\n      </div>\n      <div class=\"card-body\">\n        <div class=\" d-flex flex-column\">{{ event.description }}</div>\n        <hr>\n        <span class=\"mt-5\">{{\n          moment(event.start_date).format(\"[DATA: ] dddd DD MMMM YYYY \")\n        }}</span>\n        <br />\n        <span>{{ moment(event.start_date).format(\"[ORE: ]h:mm:ss a\") }}</span>\n\n        <p class=\"mb-0\">\n          Evento aggiunta da:\n          <!--######call user details link if not expired -->\n          <router-link\n            :to=\"{\n              name: 'user-profile',\n              params: { userUsername: event.author }\n            }\"\n            class=\"profile-link\"\n          >\n            <span class=\"author-g author-name\">{{ event.author }}</span>\n          </router-link>\n        </p>\n        <hr>\n        <!-- EventActions component in the template-->\n        <EventActions\n          v-if=\"isOwner\"\n          :slug=\"slug\"\n        />\n      </div>\n    </div>\n\n    <!----------------------------List of ReviewComponent ---------------------------->\n    <!-- fill the list with getEventReviews()                                       -->\n    <!-- @delete-review=\"deleteReview\" is triggered back from ReviewComponent       -->\n    <ReviewComponent\n      v-for=\"(review, index) in reviews\"\n      :requestUser=\"requestUser\"\n      :review=\"review\"\n      :key=\"index\"\n      @delete-review=\"deleteReview\"\n    />\n    <div class=\"my-4\">\n      <p v-show=\"loadingReviews\">loading...</p>\n    </div>\n\n    <!--if Event.userHasReviewed-->\n    <template v-if=\"userHasReviewed\">\n      <p class=\"review-added\">Hai recensito questo Evento.</p>\n    </template>\n    <!--else !userHasReviewed, if showForm -->\n    <template v-else-if=\"showForm\">\n      <!--Review form  -->\n      <ReviewForm :slug=\"slug\" />\n    </template>\n    <!--else !userHasReviewed and !showForm  -->\n    <template v-else>\n      <button\n        class=\"btn btn-sm btn-success float-left mb-2\"\n        @click=\"showForm = true\"\n      >\n        Inserisci la tua recensione\n      </button>\n    </template>\n  </div>\n</template>\n\n<script>\nimport { apiService } from \"../common/api.service\";\nimport moment from \"moment\";\nimport ReviewComponent from \"../components/Review.vue\";\nimport EventActions from \"../components/EventActions.vue\"; //to Edit/Delete Events\nimport ReviewForm from \"../components/ReviewForm.vue\";\n\nexport default {\n  name: \"Event\",\n\n  props: {\n    // used in this component\n    //to get the right Event we need his slug\n    slug: {\n      type: String,\n      required: true\n    }\n  },\n  components: {\n    //used in this component\n    ReviewComponent,\n    EventActions,\n    ReviewForm\n  },\n  data() {\n    return {\n      event: {},\n      loadingReviews: false,\n      reviews: [],\n      userHasReviewed: false,\n      showForm: false, //if userHas Not Reviewed then showForm\n      requestUser: null\n    };\n  },\n\n  computed: {\n    isOwner() {\n      return this.event.author === this.requestUser;\n    }\n  },\n\n  methods: {\n    //Events/slug/\n    getEventData() {\n      let endpoint = `/api/events/${this.slug}/`; //endpoint\n      apiService(endpoint).then(data => {\n        this.event = data;\n        this.userHasReviewed = data.user_has_reviewed;\n        this.setPageTitle(data.title);\n      });\n    },\n\n    getEventReviews() {\n      //reviews made about the event\n      let endpoint = `/api/events/${this.slug}/reviews/`;\n      //if (this.next) {                loadMoreReview part is commented\n      //  endpoint = this.next;         loadMoreReview part is commented\n      //}\n      this.loadingReviews = true;\n      apiService(endpoint).then(data => {\n        this.reviews = data.results; //.push(...data.results);  loadMoreReview part is commented\n        this.loadingReviews = false;\n        //if (data.next) {                                      loadMoreReview part is commented\n        //  this.next = data.next;\n        //} else {\n        //  this.next = null;\n        // }\n      });\n    },\n\n    async deleteReview(review) {\n      //DELETE triggered from the Review component botton\n      let endpoint = `/api/reviews/${review.id}/`;\n      try {\n        await apiService(endpoint, \"DELETE\"); //connetcting to the API, delete from DB\n        this.$delete(this.reviews, this.reviews.indexOf(review)); // delete from the array and update\n        this.userHasReviewed = false;\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    //to output the event_date in the right format, with filters\n    moment: function(date) {\n      return moment(date).locale(\"it\");\n    },\n    setPageTitle(title) {\n      document.title = title;\n    },\n    setRequestUser() {\n      this.requestUser = window.localStorage.getItem(\"username\");\n    }\n  },\n\n  //no methods\n  created() {\n    this.getEventData();\n    this.getEventReviews();\n    this.setRequestUser();\n  }\n};\n</script>\n\n<style lang=\"css\">\n.card {\n  margin-top: 0rem;\n  margin-bottom: 1rem;\n  width: 100%;\n  max-width: 80rem;\n  box-shadow: 3px 3px 20px lightgrey;\n}\n\n.card-header {\n  text-align: center;\n  padding: 10% auto;\n}\n.card img {\n  width: 90%;\n}\n.single-event {\n  margin-left: 5rem;\n  margin-right: 5rem;\n  align-content: left;\n}\n.author-g:hover {\n  color: gold;\n}\n.review-added {\n  color: red;\n  font-weight: bold;\n}\n.profile-link:hover {\n  text-decoration: none;\n}\n</style>\n"]}]}