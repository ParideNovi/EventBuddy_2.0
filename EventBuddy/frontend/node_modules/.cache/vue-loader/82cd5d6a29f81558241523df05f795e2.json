{"remainingRequest":"C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\src\\views\\Event.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\src\\views\\Event.vue","mtime":1581547309186},{"path":"C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGFwaVNlcnZpY2UgfSBmcm9tICIuLi9jb21tb24vYXBpLnNlcnZpY2UiOwppbXBvcnQgbW9tZW50IGZyb20gIm1vbWVudCI7CmltcG9ydCBSZXZpZXdDb21wb25lbnQgZnJvbSAiLi4vY29tcG9uZW50cy9SZXZpZXcudnVlIjsKaW1wb3J0IEV2ZW50QWN0aW9ucyBmcm9tICIuLi9jb21wb25lbnRzL0V2ZW50QWN0aW9ucy52dWUiOyAvL3RvIEVkaXQvRGVsZXRlIEV2ZW50cwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJFdmVudCIsCgogIHByb3BzOiB7CiAgICAvLyB1c2VkIGluIHRoaXMgY29tcG9uZW50CiAgICAvL3RvIGdldCB0aGUgcmlnaHQgRXZlbnQgd2UgbmVlZCBoaXMgc2x1ZwogICAgc2x1ZzogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICAvL3VzZWQgaW4gdGhpcyBjb21wb25lbnQKICAgIFJldmlld0NvbXBvbmVudCwKICAgIEV2ZW50QWN0aW9ucwogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGV2ZW50OiB7fSwKICAgICAgbG9hZGluZ1Jldmlld3M6IGZhbHNlLAogICAgICByZXZpZXdzOiBbXSwKICAgICAgdXNlckhhc1Jldmlld2VkOiBmYWxzZSwKICAgICAgc2hvd0Zvcm06IGZhbHNlLCAvL2lmIHVzZXJIYXMgTm90IFJldmlld2VkIHRoZW4gc2hvd0Zvcm0KICAgICAgbmV3UmV2aWV3Qm9keTogbnVsbCwKICAgICAgbmV3UmV2aWV3UmF0aW5nOiBudWxsLAogICAgICBlcnJvcjogbnVsbCwKICAgICAgbmV4dDogbnVsbCwKICAgICAgcmVxdWVzdFVzZXI6IG51bGwKICAgIH07CiAgfSwKCiAgY29tcHV0ZWQ6IHsKICAgIGlzT3duZXIoKSB7CiAgICAgIHJldHVybiB0aGlzLmV2ZW50LmF1dGhvciA9PT0gdGhpcy5yZXF1ZXN0VXNlcjsKICAgIH0KICB9LAoKICBtZXRob2RzOiB7CiAgICAvL0V2ZW50cy9zbHVnLwogICAgZ2V0RXZlbnREYXRhKCkgewogICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9ldmVudHMvJHt0aGlzLnNsdWd9L2A7IC8vZW5kcG9pbnQKICAgICAgYXBpU2VydmljZShlbmRwb2ludCkudGhlbihkYXRhID0+IHsKICAgICAgICB0aGlzLmV2ZW50ID0gZGF0YTsKICAgICAgICB0aGlzLnVzZXJIYXNSZXZpZXdlZCA9IGRhdGEudXNlcl9oYXNfcmV2aWV3ZWQ7CiAgICAgICAgdGhpcy5zZXRQYWdlVGl0bGUoZGF0YS50aXRsZSk7CiAgICAgIH0pOwogICAgfSwKCiAgICBnZXRFdmVudFJldmlld3MoKSB7CiAgICAgIC8vcmV2aWV3cyBtYWRlIGFib3V0IHRoZSBldmVudAogICAgICBsZXQgZW5kcG9pbnQgPSBgL2FwaS9ldmVudHMvJHt0aGlzLnNsdWd9L3Jldmlld3MvYDsKICAgICAgLy9pZiAodGhpcy5uZXh0KSB7ICAgICAgICAgICAgICAgIGxvYWRNb3JlUmV2aWV3IHBhcnQgaXMgY29tbWVudGVkCiAgICAgIC8vICBlbmRwb2ludCA9IHRoaXMubmV4dDsgICAgICAgICBsb2FkTW9yZVJldmlldyBwYXJ0IGlzIGNvbW1lbnRlZAogICAgICAvL30KICAgICAgdGhpcy5sb2FkaW5nUmV2aWV3cyA9IHRydWU7CiAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQpLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgdGhpcy5yZXZpZXdzID0gZGF0YS5yZXN1bHRzOyAvLy5wdXNoKC4uLmRhdGEucmVzdWx0cyk7ICBsb2FkTW9yZVJldmlldyBwYXJ0IGlzIGNvbW1lbnRlZAogICAgICAgIHRoaXMubG9hZGluZ1Jldmlld3MgPSBmYWxzZTsKICAgICAgICAvL2lmIChkYXRhLm5leHQpIHsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRNb3JlUmV2aWV3IHBhcnQgaXMgY29tbWVudGVkCiAgICAgICAgLy8gIHRoaXMubmV4dCA9IGRhdGEubmV4dDsKICAgICAgICAvL30gZWxzZSB7CiAgICAgICAgLy8gIHRoaXMubmV4dCA9IG51bGw7CiAgICAgICAgLy8gfQogICAgICB9KTsKICAgIH0sCgogICAgb25TdWJtaXQoKSB7CiAgICAgIC8vY2hlY2sgZmllbGRzCiAgICAgIGlmICghdGhpcy5uZXdSZXZpZXdCb2R5KSB7CiAgICAgICAgdGhpcy5lcnJvciA9ICJJbCBjYW1wbyByZWNlbnNpb25lIG5vbiBwdcOyIGVzc2VyZSB2dW90byEiOwogICAgICB9IGVsc2UgaWYgKCF0aGlzLm5ld1Jldmlld1JhdGluZykgewogICAgICAgIHRoaXMuZXJyb3IgPSAiSWwgY2FtcG8gcHVudGVnZ2lvIG5vbiBwdcOyIGVzc2VyZSB2dW90byEiOwogICAgICB9IGVsc2UgewogICAgICAgIC8vUE9TVCBlbmRwb2ludAogICAgICAgIGxldCBlbmRwb2ludCA9IGAvYXBpL2V2ZW50cy8ke3RoaXMuc2x1Z30vcmV2aWV3L2A7CiAgICAgICAgbGV0IG1ldGhvZCA9ICJQT1NUIjsKICAgICAgICAvL2NhbGwgdGhlIHNlcnZpY2UgZm9yIHRoZSByZXF1ZXN0IGFuZCB0aGVuLi4KICAgICAgICBhcGlTZXJ2aWNlKGVuZHBvaW50LCBtZXRob2QsIHsKICAgICAgICAgIGJvZHk6IHRoaXMubmV3UmV2aWV3Qm9keSwKICAgICAgICAgIHJhdGluZzogdGhpcy5uZXdSZXZpZXdSYXRpbmcKICAgICAgICB9KS50aGVuKGRhdGEgPT4gewogICAgICAgICAgLy9hZGQgbXkgcmV2aWV3CiAgICAgICAgICB0aGlzLnJldmlld3MudW5zaGlmdChkYXRhKTsKICAgICAgICB9KTsKICAgICAgICAvL2luaXRpYWxpemUgYXR0cmlidXRlcwogICAgICAgIGlmICh0aGlzLmVycm9yKSB7CiAgICAgICAgICB0aGlzLmVycm9yID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgdGhpcy5uZXdSZXZpZXdCb2R5ID0gbnVsbDsKICAgICAgICB0aGlzLnNob3dGb3JtID0gZmFsc2U7CiAgICAgICAgdGhpcy51c2VySGFzUmV2aWV3ZWQgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgYXN5bmMgZGVsZXRlUmV2aWV3KHJldmlldykgewogICAgICAvL0RFTEVURSB0cmlnZ2VyZWQgZnJvbSB0aGUgUmV2aWV3IGNvbXBvbmVudCBib3R0b24KICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvcmV2aWV3cy8ke3Jldmlldy5pZH0vYDsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCBhcGlTZXJ2aWNlKGVuZHBvaW50LCAiREVMRVRFIik7IC8vY29ubmV0Y3RpbmcgdG8gdGhlIEFQSSwgZGVsZXRlIGZyb20gREIKICAgICAgICB0aGlzLiRkZWxldGUodGhpcy5yZXZpZXdzLCB0aGlzLnJldmlld3MuaW5kZXhPZihyZXZpZXcpKTsgLy8gZGVsZXRlIGZyb20gdGhlIGFycmF5IGFuZCB1cGRhdGUKICAgICAgICB0aGlzLnVzZXJIYXNSZXZpZXdlZCA9IGZhbHNlOwogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICB9CiAgICB9LAogICAgLy90byBvdXRwdXQgdGhlIGV2ZW50X2RhdGUgaW4gdGhlIHJpZ2h0IGZvcm1hdCwgd2l0aCBmaWx0ZXJzCiAgICBtb21lbnQ6IGZ1bmN0aW9uKGRhdGUpIHsKICAgICAgcmV0dXJuIG1vbWVudChkYXRlKS5sb2NhbGUoIml0Iik7CiAgICB9LAogICAgc2V0UGFnZVRpdGxlKHRpdGxlKSB7CiAgICAgIGRvY3VtZW50LnRpdGxlID0gdGl0bGU7CiAgICB9LAogICAgc2V0UmVxdWVzdFVzZXIoKSB7CiAgICAgIHRoaXMucmVxdWVzdFVzZXIgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXJuYW1lIik7CiAgICB9CiAgfSwKCiAgLy9ubyBtZXRob2RzCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0RXZlbnREYXRhKCk7CiAgICB0aGlzLmdldEV2ZW50UmV2aWV3cygpOwogICAgdGhpcy5zZXRSZXF1ZXN0VXNlcigpOwogIH0KfTsK"},{"version":3,"sources":["Event.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4IA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Event.vue","sourceRoot":"src/views","sourcesContent":["<!--Single Event component/event details page \"api/event/:slug\", \nReviews: v-for ReviewComponent\nif it is expired then it is possible to add a review -->\n<template>\n  <div class=\"single-event mt-2\">\n    <div class=\"container\">\n      <!-------------------------------Event details-------------------------------------->\n      <!--######<p> {{ event.image }}</p>-->\n      <h1>{{ event.title }}</h1>\n      <!-- EventActions component in the template-->\n      <EventActions\n        v-if=\"isOwner\"\n        :slug=\"slug\"\n      />\n      <span>{{ moment(event.start_date).format(\"dddd DD MMMM, h:mm:ss a\") }}</span>\n      <p class=\"mb-0\">Evento aggiunta da:\n        <!--######call user details link if not expired -->\n        <span class=\"author-name\">{{ event.author }}</span>\n      </p>\n      <hr>\n\n      <!-- <div class=\"reviews-list-if-event-expired> -->\n\n      <!--check field if Event.userHasReviewed, \n      else showForm to insert a Review  -->\n      <template v-if=\"userHasReviewed\">\n        <p class=\"review-added\"> Hai recensito questo Evento. </p>\n      </template>\n      <template v-else-if=\"showForm\">\n        <form\n          class=\"card\"\n          @submit.prevent=\"onSubmit\"\n        >\n          <div class=\"card-header px-3\">Aggiungi la tua recensione dell'evento</div>\n          <div class=\"card-block\">\n            <textarea\n              v-model=\"newReviewBody\"\n              rows=\"5\"\n              class=\"form-control\"\n              placeholder=\"Recensione..\"\n            > </textarea>\n\n            <!--rating stars input (component)-->\n            <!------------------------->\n            <form class=\"rating\">\n              <label>\n                <input\n                  v-model=\"newReviewRating\"\n                  type=\"radio\"\n                  name=\"stars\"\n                  value=\"1\"\n                />\n                <span class=\"icon\">★</span>\n              </label>\n              <label>\n                <input\n                  v-model=\"newReviewRating\"\n                  type=\"radio\"\n                  name=\"stars\"\n                  value=\"2\"\n                />\n                <span class=\"icon\">★</span>\n                <span class=\"icon\">★</span>\n              </label>\n              <label>\n                <input\n                  v-model=\"newReviewRating\"\n                  type=\"radio\"\n                  name=\"stars\"\n                  value=\"3\"\n                />\n                <span class=\"icon\">★</span>\n                <span class=\"icon\">★</span>\n                <span class=\"icon\">★</span>\n              </label>\n              <label>\n                <input\n                  v-model=\"newReviewRating\"\n                  type=\"radio\"\n                  name=\"stars\"\n                  value=\"4\"\n                />\n                <span class=\"icon\">★</span>\n                <span class=\"icon\">★</span>\n                <span class=\"icon\">★</span>\n                <span class=\"icon\">★</span>\n              </label>\n              <label>\n                <input\n                  v-model=\"newReviewRating\"\n                  type=\"radio\"\n                  name=\"stars\"\n                  value=\"5\"\n                />\n                <span class=\"icon\">★</span>\n                <span class=\"icon\">★</span>\n                <span class=\"icon\">★</span>\n                <span class=\"icon\">★</span>\n                <span class=\"icon\">★</span>\n              </label>\n            </form>\n\n          </div>\n          <div class=\"card-footer px-3\">\n            <button\n              type=\"submit\"\n              class=\"btn btn-sm btn-success\"\n            > Inserisci la tua recensione\n            </button>\n          </div>\n        </form>\n        <p class=\"error mt-2\">{{error}}</p>\n      </template>\n      <template v-else>\n        <button\n          class=\"btn btn-sm btn-success\"\n          @click=\"showForm=true\"\n        >\n          Inserisci la tua recensione </button>\n      </template>\n\n      <!--Create a List of ReviewComponent and fill them with getEventReviews()-->\n      <!--@delete-review=\"deleteReview\" is triggered back from Answercomponent -->\n      <ReviewComponent\n        v-for=\"(review, index) in reviews\"\n        :requestUser=\"requestUser\"\n        :review=\"review\"\n        :key=\"index\"\n        @delete-review=\"deleteReview\"\n      />\n      <div class=\"my-4\">\n        <p v-show=\"loadingReviews\">loading...</p>\n      </div>\n\n    </div>\n  </div>\n</template>\n\n\n<script>\nimport { apiService } from \"../common/api.service\";\nimport moment from \"moment\";\nimport ReviewComponent from \"../components/Review.vue\";\nimport EventActions from \"../components/EventActions.vue\"; //to Edit/Delete Events\n\nexport default {\n  name: \"Event\",\n\n  props: {\n    // used in this component\n    //to get the right Event we need his slug\n    slug: {\n      type: String,\n      required: true\n    }\n  },\n  components: {\n    //used in this component\n    ReviewComponent,\n    EventActions\n  },\n  data() {\n    return {\n      event: {},\n      loadingReviews: false,\n      reviews: [],\n      userHasReviewed: false,\n      showForm: false, //if userHas Not Reviewed then showForm\n      newReviewBody: null,\n      newReviewRating: null,\n      error: null,\n      next: null,\n      requestUser: null\n    };\n  },\n\n  computed: {\n    isOwner() {\n      return this.event.author === this.requestUser;\n    }\n  },\n\n  methods: {\n    //Events/slug/\n    getEventData() {\n      let endpoint = `/api/events/${this.slug}/`; //endpoint\n      apiService(endpoint).then(data => {\n        this.event = data;\n        this.userHasReviewed = data.user_has_reviewed;\n        this.setPageTitle(data.title);\n      });\n    },\n\n    getEventReviews() {\n      //reviews made about the event\n      let endpoint = `/api/events/${this.slug}/reviews/`;\n      //if (this.next) {                loadMoreReview part is commented\n      //  endpoint = this.next;         loadMoreReview part is commented\n      //}\n      this.loadingReviews = true;\n      apiService(endpoint).then(data => {\n        this.reviews = data.results; //.push(...data.results);  loadMoreReview part is commented\n        this.loadingReviews = false;\n        //if (data.next) {                                      loadMoreReview part is commented\n        //  this.next = data.next;\n        //} else {\n        //  this.next = null;\n        // }\n      });\n    },\n\n    onSubmit() {\n      //check fields\n      if (!this.newReviewBody) {\n        this.error = \"Il campo recensione non può essere vuoto!\";\n      } else if (!this.newReviewRating) {\n        this.error = \"Il campo punteggio non può essere vuoto!\";\n      } else {\n        //POST endpoint\n        let endpoint = `/api/events/${this.slug}/review/`;\n        let method = \"POST\";\n        //call the service for the request and then..\n        apiService(endpoint, method, {\n          body: this.newReviewBody,\n          rating: this.newReviewRating\n        }).then(data => {\n          //add my review\n          this.reviews.unshift(data);\n        });\n        //initialize attributes\n        if (this.error) {\n          this.error = null;\n        }\n        this.newReviewBody = null;\n        this.showForm = false;\n        this.userHasReviewed = true;\n      }\n    },\n    async deleteReview(review) {\n      //DELETE triggered from the Review component botton\n      let endpoint = `/api/reviews/${review.id}/`;\n      try {\n        await apiService(endpoint, \"DELETE\"); //connetcting to the API, delete from DB\n        this.$delete(this.reviews, this.reviews.indexOf(review)); // delete from the array and update\n        this.userHasReviewed = false;\n      } catch (err) {\n        console.log(err);\n      }\n    },\n    //to output the event_date in the right format, with filters\n    moment: function(date) {\n      return moment(date).locale(\"it\");\n    },\n    setPageTitle(title) {\n      document.title = title;\n    },\n    setRequestUser() {\n      this.requestUser = window.localStorage.getItem(\"username\");\n    }\n  },\n\n  //no methods\n  created() {\n    this.getEventData();\n    this.getEventReviews();\n    this.setRequestUser();\n  }\n};\n</script>\n\n<style lang=\"css\">\n.review-added {\n  color: red;\n  font-weight: bold;\n}\n.rating {\n  display: inline-block;\n  position: relative;\n  height: 50px;\n  line-height: 50px;\n  font-size: 50px;\n}\n\n.rating label {\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  cursor: pointer;\n}\n\n.rating label:last-child {\n  position: static;\n}\n\n.rating label:nth-child(1) {\n  z-index: 5;\n}\n\n.rating label:nth-child(2) {\n  z-index: 4;\n}\n\n.rating label:nth-child(3) {\n  z-index: 3;\n}\n\n.rating label:nth-child(4) {\n  z-index: 2;\n}\n\n.rating label:nth-child(5) {\n  z-index: 1;\n}\n\n.rating label input {\n  position: absolute;\n  top: 0;\n  left: 0;\n  opacity: 0;\n}\n\n.rating label .icon {\n  float: left;\n  color: transparent;\n}\n\n.rating label:last-child .icon {\n  color: #000;\n}\n\n.rating:not(:hover) label input:checked ~ .icon,\n.rating:hover label:hover input ~ .icon {\n  color: #09f;\n}\n\n.rating label input:focus:not(:checked) ~ .icon:last-child {\n  color: #000;\n  text-shadow: 0 0 5px #09f;\n}\n</style>\n"]}]}