{"remainingRequest":"C:\\Users\\Paride\\Desktop\\EventBuddy-master\\EventBuddy\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Paride\\Desktop\\EventBuddy-master\\EventBuddy\\frontend\\src\\views\\EventEditor.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Paride\\Desktop\\EventBuddy-master\\EventBuddy\\frontend\\src\\views\\EventEditor.vue","mtime":1582064714000},{"path":"C:\\Users\\Paride\\Desktop\\EventBuddy-master\\EventBuddy\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\Desktop\\EventBuddy-master\\EventBuddy\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\Desktop\\EventBuddy-master\\EventBuddy\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\Desktop\\EventBuddy-master\\EventBuddy\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGFwaVNlcnZpY2UgfSBmcm9tICIuLi9jb21tb24vYXBpLnNlcnZpY2UiOwppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOwppbXBvcnQgeyBDU1JGX1RPS0VOIH0gZnJvbSAiLi4vY29tbW9uL2NzcmZfdG9rZW4uanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkV2ZW50RWRpdG9yIiwKCiAgcHJvcHM6IHsKICAgIHNsdWc6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICByZXF1aXJlZDogZmFsc2UgLy9zbHVnIG9wdGlvbmFsIGluIGNhc2UgaXMgbmV3IEV2ZW50CiAgICB9LAogICAgcHJldmlvdXNFdmVudDogewogICAgICAvL3RoZSBFdmVudCB0byBiZSBtb2RpZnkKICAgICAgdHlwZTogU3RyaW5nLAogICAgICByZXF1aXJlZDogZmFsc2UKICAgIH0KICB9LAoKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZXZlbnRfdGl0bGU6IHRoaXMucHJldmlvdXNFdmVudC50aXRsZSB8fCBudWxsLAogICAgICBldmVudF9kZXNjcmlwdGlvbjogdGhpcy5wcmV2aW91c0V2ZW50LmRlc2NyaXB0aW9uIHx8IG51bGwsCiAgICAgIHN0YXJ0X2RhdGU6IHRoaXMucHJldmlvdXNFdmVudC5zdGFydF9kYXRlIHx8IG51bGwsCiAgICAgIGV2ZW50X2xvY2F0aW9uOiB0aGlzLnByZXZpb3VzRXZlbnQubG9jYXRpb24gfHwgbnVsbCwKICAgICAgZXZlbnRfcHJpY2U6IHRoaXMucHJldmlvdXNFdmVudC5wcmljZSB8fCBudWxsLAogICAgICBldmVudF9ncm91cF9saW1pdDogdGhpcy5wcmV2aW91c0V2ZW50Lmdyb3VwX2xpbWl0IHx8IG51bGwsCiAgICAgIGV2ZW50X3BpY3R1cmU6IG51bGwsCiAgICAgIGVycm9yOiBudWxsCiAgICB9OwogIH0sCgogIC8vdG8gZnVsbCB0aGUgZmllbGRzIGZvciB0aGUgZWRpdCBFdmVudAogIGFzeW5jIGJlZm9yZVJvdXRlRW50ZXIodG8sIGZyb20sIG5leHQpIHsKICAgIC8vaWYgc2x1ZyBleGlzdAogICAgaWYgKHRvLnBhcmFtcy5zbHVnICE9PSB1bmRlZmluZWQpIHsKICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvZXZlbnRzLyR7dG8ucGFyYW1zLnNsdWd9L2A7CiAgICAgIGF3YWl0IGFwaVNlcnZpY2UoZW5kcG9pbnQpLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgdG8ucGFyYW1zLnByZXZpb3VzRXZlbnQgPSBkYXRhOwogICAgICB9KTsKICAgIH0KICAgIHJldHVybiBuZXh0KCk7CiAgfSwKCiAgbWV0aG9kczogewogICAgaGFuZGxlRmlsZVVwbG9hZCgpIHsKICAgICAgdGhpcy5ldmVudF9waWN0dXJlID0gdGhpcy4kcmVmcy5maWxlLmZpbGVzWzBdOwogICAgICBjb25zb2xlLmxvZyh0aGlzLmV2ZW50X3BpY3R1cmUubmFtZSk7CiAgICB9LAogICAgLyoKICAgICAgICBIYW5kbGVzIGEgY2hhbmdlIG9uIHRoZSBmaWxlIHVwbG9hZAogICAgICAqLwoKICAgIHN1Ym1pdEZpbGUoKSB7CiAgICAgIC8qCiAgICAgICAgICAgICAgICBJbml0aWFsaXplIHRoZSBmb3JtIGRhdGEKICAgICAgICAgICAgKi8KICAgICAgbGV0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CgogICAgICAvKgogICAgICAgICAgICAgICAgQWRkIHRoZSBmb3JtIGRhdGEgd2UgbmVlZCB0byBzdWJtaXQKICAgICAgICAgICAgKi8KICAgICAgZm9ybURhdGEuYXBwZW5kKAogICAgICAgICJmaWxlIiwKICAgICAgICB0aGlzLmV2ZW50X3BpY3R1cmUsCiAgICAgICAgInRpdGxlIiwKICAgICAgICB0aGlzLmV2ZW50X3RpdGxlLAogICAgICAgICJkZXNjcmlwdGlvbiIsCiAgICAgICAgdGhpcy5ldmVudF9kZXNjcmlwdGlvbiwKICAgICAgICAic3RhcnRfZGF0ZSIsCiAgICAgICAgdGhpcy5zdGFydF9kYXRlLAogICAgICAgICJsb2NhdGlvbiIsCiAgICAgICAgdGhpcy5ldmVudF9sb2NhdGlvbiwKICAgICAgICAicHJpY2UiLAogICAgICAgIHRoaXMuZXZlbnRfcHJpY2UsCiAgICAgICAgImdyb3VwX2xpbWl0IiwKICAgICAgICB0aGlzLmV2ZW50X2dyb3VwX2xpbWl0CiAgICAgICk7CgogICAgICAvKgogICAgICAgICAgTWFrZSB0aGUgcmVxdWVzdCB0byB0aGUgUE9TVCBgYXBpL3Byb2ZpbGVzLyR7dGhpcy51c2VyVXNlcm5hbWV9L2F2YXRhci9gIFVSTCAgCiAgICAgICAgKi8KICAgICAgYXhpb3MKICAgICAgICAucG9zdChgaHR0cDovLzEyNy4wLjAuMTo4MDAwL2FwaS9ldmVudHMvYCwgZm9ybURhdGEsIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJtdWx0aXBhcnQvZm9ybS1kYXRhIiwKICAgICAgICAgICAgIlgtQ1NSRlRva2VuIjogQ1NSRl9UT0tFTgogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiU1VDQ0VTUyEhIik7CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZnVuY3Rpb24oKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygiRkFJTFVSRSEhIik7CiAgICAgICAgfSk7CiAgICB9LAogICAgb25TdWJtaXQoKSB7CiAgICAgIC8vY2hlY2sgdGl0bGUgZmllbGQKICAgICAgaWYgKCF0aGlzLmV2ZW50X3RpdGxlKSB7CiAgICAgICAgdGhpcy5lcnJvciA9ICJJbCBjYW1wbyB0aXRvbG8gbm9uIHB1w7IgZXNzZXJlIHZ1b3RvISI7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5ldmVudF90aXRsZS5sZW5ndGggPiAyNDApIHsKICAgICAgICB0aGlzLmVycm9yID0gIk5vbiBzdXBlcmFyZSBpIDI0MCBjYXJhdHRlcmkgcGVyIGlsIHRpdG9sbyI7CiAgICAgICAgLy9jaGVjayBkZXNjcmlwdGlvbiBmaWVsZAogICAgICB9IGVsc2UgaWYgKCF0aGlzLmV2ZW50X2Rlc2NyaXB0aW9uKSB7CiAgICAgICAgdGhpcy5lcnJvciA9ICJJbCBjYW1wbyBkZXNjcml6aW9uZSBub24gcHXDsiBlc3NlcmUgdnVvdG8hIjsKICAgICAgfSBlbHNlIGlmICh0aGlzLmV2ZW50X3RpdGxlLmxlbmd0aCA+IDQwMCkgewogICAgICAgIHRoaXMuZXJyb3IgPSAiTm9uIHN1cGVyYXJlIGkgNDAwIGNhcmF0dGVyaSBwZXIgbGEgZGVzY3JpemlvbmUiOwogICAgICAgIC8vY2hlY2sgbG9jYXRpb24gZmllbGQKICAgICAgfSBlbHNlIGlmICghdGhpcy5ldmVudF9sb2NhdGlvbikgewogICAgICAgIHRoaXMuZXJyb3IgPSAiSWwgY2FtcG8gY2l0dMOgIG5vbiBwdcOyIGVzc2VyZSB2dW90byEiOwogICAgICB9IGVsc2UgaWYgKHRoaXMuZXZlbnRfbG9jYXRpb24ubGVuZ3RoID4gNDApIHsKICAgICAgICB0aGlzLmVycm9yID0gIk5vbiBzdXBlcmFyZSBpIDQwIGNhcmF0dGVyaSBwZXIgbGEgY2l0dMOgIjsKICAgICAgICAvL2dldCB0aGUgZW5kcG9pbnQgYW5kIHRoZSBtZXRob2Qgb2YgdGhlIEFQSS9ldmVudHMKICAgICAgfSBlbHNlIHsKICAgICAgICBsZXQgZW5kcG9pbnQgPSAiL2FwaS9ldmVudHMvIjsKICAgICAgICBsZXQgbWV0aG9kID0gIlBPU1QiOwogICAgICAgIC8vIGluIGNhc2UgbW9kaWZ5IEV2ZW50CiAgICAgICAgaWYgKHRoaXMucHJldmlvdXNFdmVudCkgewogICAgICAgICAgbWV0aG9kID0gIlBVVCI7CiAgICAgICAgICBlbmRwb2ludCArPSBgJHt0aGlzLnNsdWd9L2A7CiAgICAgICAgfQoKICAgICAgICAvLyBjb25zdCBmZCA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgIC8vIGZkLmFwcGVuZCgiaW1hZ2UiLCB0aGlzLmV2ZW50X3BpY3R1cmUsIHRoaXMuZXZlbnRfcGljdHVyZS5uYW1lKTsKICAgICAgICAvLyBheGlvcy5wb3N0KCJodHRwOi8vMTI3LjAuMC4xOjgwMDAvbWVkaWEvIiwgZmQpLnRoZW4ocmVzID0+IHsKICAgICAgICAvLyAgIGNvbnNvbGUubG9nKHJlcyk7IC8vaG9zdCB3ZWIgbGlrZSBmaXJlYmFzZQogICAgICAgIC8vIH0pOwogICAgICAgIC8vY2FsbCB0aGUgc2VydmljZSBmb3IgdGhlIHJlcXVlc3QgYW5kIHRoZW4uLgogICAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQsIG1ldGhvZCwgewogICAgICAgICAgdGl0bGU6IHRoaXMuZXZlbnRfdGl0bGUsCiAgICAgICAgICBkZXNjcmlwdGlvbjogdGhpcy5ldmVudF9kZXNjcmlwdGlvbiwKICAgICAgICAgIHN0YXJ0X2RhdGU6IHRoaXMuc3RhcnRfZGF0ZSwKICAgICAgICAgIGxvY2F0aW9uOiB0aGlzLmV2ZW50X2xvY2F0aW9uLAogICAgICAgICAgcHJpY2U6IHRoaXMuZXZlbnRfcHJpY2UsCiAgICAgICAgICBncm91cF9saW1pdDogdGhpcy5ldmVudF9ncm91cF9saW1pdAogICAgICAgICAgLy9waWN0dXJlOiBmZAogICAgICAgIH0pLnRoZW4oZXZlbnRfZGF0YSA9PiB7CiAgICAgICAgICAvL3JlZGlyZWN0IHJvdXRlciB0byB0aGUgZXZlbnQgZGVzY3JpcHRpb24KICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgbmFtZTogImV2ZW50IiwKICAgICAgICAgICAgcGFyYW1zOiB7IHNsdWc6IGV2ZW50X2RhdGEuc2x1ZyB9CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sCgogIGNyZWF0ZWQoKSB7CiAgICBkb2N1bWVudC50aXRsZSA9ICJFZGl0b3IgLSBFdmVudEJ1ZGR5IjsKICB9Cn07Cg=="},{"version":3,"sources":["EventEditor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"EventEditor.vue","sourceRoot":"src/views","sourcesContent":["<!--Event: If Add a new Event-->\n<template>\n  <div class=\" eventeditor-view  \">\n    <div class=\"container-eventeditor\">\n      <div class=\"card card-6\">\n        <div class=\"card-heading\">\n          <h1 class=\"mb-3 text-center\">Aggiungi un evento</h1>\n        </div>\n        <div class=\"card-body\">\n          <form @submit.prevent=\"onSubmit\">\n            <!--@ onSubmit.prevent = prevent the page to reload  -->\n            <textarea\n              v-model=\"event_title\"\n              class=\"form-control\"\n              placeholder=\"Quale è il titolo?\"\n              rows=\"1\"\n            >\n            </textarea>\n            <textarea\n              v-model=\"event_description\"\n              class=\"form-control\"\n              placeholder=\"Descrizione\"\n              rows=\"4\"\n            >\n            </textarea>\n            <div class=\"form-row mt-2\">\n              <div class=\"col\">\n                <div class=\"name\">Città evento</div>\n                <input\n                  v-model=\"event_location\"\n                  class=\"input--style-6\"\n                  type=\"text\"\n                  placeholder=\"Città\"\n                  rows=\"1\"\n                />\n              </div>\n              <div class=\"col\">\n                <div class=\"name\">Data e Ora evento</div>\n                <input\n                  type=\"datetime-local\"\n                  id=\"event-time\"\n                  name=\"event-time\"\n                  v-model=\"start_date\"\n                  value=\"\"\n                  required\n                />\n              </div>\n            </div>\n            <div class=\"form-row\">\n              <div class=\"col\">\n                <div class=\"name\">Prezzo</div>\n                <input\n                  type=\"number\"\n                  step=\"0.1\"\n                  v-model=\"event_price\"\n                  class=\"input--style-6\"\n                  placeholder=\"0.0\"\n                />\n              </div>\n              <div class=\"col\">\n                <div class=\"name\">Dimensione Gruppo</div>\n                <input\n                  type=\"number\"\n                  step=\"1\"\n                  v-model=\"event_group_limit\"\n                  class=\"input--style-6\"\n                  placeholder=\"0\"\n                />\n              </div>\n            </div>\n            <!-- btn Upload image-->\n            <div class=\"mt-2 col-sm-4\">\n              <div class=\"name\">Immagine evento</div>\n              <div class=\"btn blue-gradient btn-sm float-left\">\n                <input\n                  type=\"file\"\n                  id=\"file\"\n                  ref=\"file\"\n                  v-on:change=\"handleFileUpload()\"\n                />\n              </div>\n            </div>\n\n            <button\n              class=\"btn btn-success\"\n              type=\"submit\"\n            >\n              Pubblica Evento\n            </button>\n          </form>\n        </div>\n\n        <div class=\"card-footer\">\n          <br />\n          <p class=\"error mt-2\">{{ error }}</p>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { apiService } from \"../common/api.service\";\nimport axios from \"axios\";\nimport { CSRF_TOKEN } from \"../common/csrf_token.js\";\nexport default {\n  name: \"EventEditor\",\n\n  props: {\n    slug: {\n      type: String,\n      required: false //slug optional in case is new Event\n    },\n    previousEvent: {\n      //the Event to be modify\n      type: String,\n      required: false\n    }\n  },\n\n  data() {\n    return {\n      event_title: this.previousEvent.title || null,\n      event_description: this.previousEvent.description || null,\n      start_date: this.previousEvent.start_date || null,\n      event_location: this.previousEvent.location || null,\n      event_price: this.previousEvent.price || null,\n      event_group_limit: this.previousEvent.group_limit || null,\n      event_picture: null,\n      error: null\n    };\n  },\n\n  //to full the fields for the edit Event\n  async beforeRouteEnter(to, from, next) {\n    //if slug exist\n    if (to.params.slug !== undefined) {\n      let endpoint = `/api/events/${to.params.slug}/`;\n      await apiService(endpoint).then(data => {\n        to.params.previousEvent = data;\n      });\n    }\n    return next();\n  },\n\n  methods: {\n    handleFileUpload() {\n      this.event_picture = this.$refs.file.files[0];\n      console.log(this.event_picture.name);\n    },\n    /*\n        Handles a change on the file upload\n      */\n\n    submitFile() {\n      /*\n                Initialize the form data\n            */\n      let formData = new FormData();\n\n      /*\n                Add the form data we need to submit\n            */\n      formData.append(\n        \"file\",\n        this.event_picture,\n        \"title\",\n        this.event_title,\n        \"description\",\n        this.event_description,\n        \"start_date\",\n        this.start_date,\n        \"location\",\n        this.event_location,\n        \"price\",\n        this.event_price,\n        \"group_limit\",\n        this.event_group_limit\n      );\n\n      /*\n          Make the request to the POST `api/profiles/${this.userUsername}/avatar/` URL  \n        */\n      axios\n        .post(`http://127.0.0.1:8000/api/events/`, formData, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\",\n            \"X-CSRFToken\": CSRF_TOKEN\n          }\n        })\n        .then(function() {\n          console.log(\"SUCCESS!!\");\n        })\n        .catch(function() {\n          console.log(\"FAILURE!!\");\n        });\n    },\n    onSubmit() {\n      //check title field\n      if (!this.event_title) {\n        this.error = \"Il campo titolo non può essere vuoto!\";\n      } else if (this.event_title.length > 240) {\n        this.error = \"Non superare i 240 caratteri per il titolo\";\n        //check description field\n      } else if (!this.event_description) {\n        this.error = \"Il campo descrizione non può essere vuoto!\";\n      } else if (this.event_title.length > 400) {\n        this.error = \"Non superare i 400 caratteri per la descrizione\";\n        //check location field\n      } else if (!this.event_location) {\n        this.error = \"Il campo città non può essere vuoto!\";\n      } else if (this.event_location.length > 40) {\n        this.error = \"Non superare i 40 caratteri per la città\";\n        //get the endpoint and the method of the API/events\n      } else {\n        let endpoint = \"/api/events/\";\n        let method = \"POST\";\n        // in case modify Event\n        if (this.previousEvent) {\n          method = \"PUT\";\n          endpoint += `${this.slug}/`;\n        }\n\n        // const fd = new FormData();\n        // fd.append(\"image\", this.event_picture, this.event_picture.name);\n        // axios.post(\"http://127.0.0.1:8000/media/\", fd).then(res => {\n        //   console.log(res); //host web like firebase\n        // });\n        //call the service for the request and then..\n        apiService(endpoint, method, {\n          title: this.event_title,\n          description: this.event_description,\n          start_date: this.start_date,\n          location: this.event_location,\n          price: this.event_price,\n          group_limit: this.event_group_limit\n          //picture: fd\n        }).then(event_data => {\n          //redirect router to the event description\n          this.$router.push({\n            name: \"event\",\n            params: { slug: event_data.slug }\n          });\n        });\n      }\n    }\n  },\n\n  created() {\n    document.title = \"Editor - EventBuddy\";\n  }\n};\n</script>\n\n<style>\n.eventeditor-view {\n  padding-right: 5rem;\n  padding-left: 5rem;\n  padding-bottom: 1rem;\n  background-color: #1a1a1a;\n}\n\n.container-eventeditor {\n  margin-bottom: 5rem;\n}\n.name {\n  font-style: italic;\n}\n.file {\n  visibility: hidden;\n  position: absolute;\n}\n</style>\n"]}]}