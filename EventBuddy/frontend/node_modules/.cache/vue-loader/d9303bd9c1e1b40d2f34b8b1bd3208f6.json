{"remainingRequest":"C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\src\\views\\ProfileEditor.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\src\\views\\ProfileEditor.vue","mtime":1581253437475},{"path":"C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Paride\\OneDrive - Politecnico di Milano\\progetto\\Progetto Finale\\EventBuddy\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBhcGlTZXJ2aWNlIH0gZnJvbSAiLi4vY29tbW9uL2FwaS5zZXJ2aWNlIjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiUHJvZmlsZUVkaXRvciIsDQoNCiAgcHJvcHM6IHsNCiAgICB1c2VyVXNlcm5hbWU6IHsNCiAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgIHJlcXVpcmVkOiB0cnVlDQogICAgfSwNCiAgICBwcmV2aW91c1Byb2ZpbGU6IHsNCiAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgIHJlcXVpcmVkOiBmYWxzZQ0KICAgIH0NCiAgfSwNCg0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICAvLyAgcHJvZmlsZV9hdmF0YXI6IHRoaXMucHJldmlvdXNQcm9maWxlIHx8IG51bGwsDQogICAgICBwcm9maWxlX2JpbzogdGhpcy5wcmV2aW91c1Byb2ZpbGUgfHwgbnVsbCwNCiAgICAgIHByb2ZpbGVfbG9jYXRpb246IHRoaXMucHJldmlvdXNQcm9maWxlIHx8IG51bGwsDQogICAgICBwcm9maWxlX2JpcnRoX2RhdGU6IHRoaXMucHJldmlvdXNQcm9maWxlIHx8IG51bGwsDQogICAgICBlcnJvcjogbnVsbA0KICAgIH07DQogIH0sDQogIC8vdG8gZmlsbCB0aGUgZmllbGRzIGF0IG9uUGFnZUxvYWQ/Pw0KICBhc3luYyBiZWZvcmVSb3V0ZUVudGVyKHRvLCBmcm9tLCBuZXh0KSB7DQogICAgaWYgKHRvLnBhcmFtcy51c2VyVXNlcm5hbWUgIT09IHVuZGVmaW5lZCkgew0KICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvcHJvZmlsZXMvJHt0by5wYXJhbXMudXNlclVzZXJuYW1lfS9gOw0KICAgICAgYXdhaXQgYXBpU2VydmljZShlbmRwb2ludCkudGhlbihkYXRhID0+IHsNCiAgICAgICAgdG8ucGFyYW1zLnByZXZpb3VzUHJvZmlsZSA9IGRhdGEuY29udGVudDsNCiAgICAgIH0pOw0KICAgIH0NCiAgICByZXR1cm4gbmV4dCgpOw0KICB9LA0KDQogIG1ldGhvZHM6IHsNCiAgICBvblN1Ym1pdCgpIHsNCiAgICAgIC8vUE9TVCBpbiB0aGUgQVBJL3Byb2ZpbGVzLw0KICAgICAgbGV0IGVuZHBvaW50ID0gYC9hcGkvcHJvZmlsZXMvJHt0aGlzLnVzZXJVc2VybmFtZX0vYDsNCiAgICAgIGxldCBtZXRob2QgPSAiUFVUIjsNCiAgICAgIC8vaWYgKHRoaXMucHJldmlvdXNQcm9maWxlKSB7DQogICAgICAvLyAgbWV0aG9kID0gIlBVVCI7DQogICAgICAvLyAgZW5kcG9pbnQgKz0gYCR7dGhpcy51c2VyVXNlcm5hbWV9L2A7DQogICAgICAvL30gLy9jYWxsIHRoZSBzZXJ2aWNlIGZvciB0aGUgUE9TVCByZXF1ZXN0IGFuZCB0aGVuLi4NCiAgICAgIGFwaVNlcnZpY2UoZW5kcG9pbnQsIG1ldGhvZCwgew0KICAgICAgICAvL2F2YXRhcjogdGhpcy5wcm9maWxlX2F2YXRhciwNCiAgICAgICAgYmlvOiB0aGlzLnByb2ZpbGVfYmlvLA0KICAgICAgICBsb2NhdGlvbjogdGhpcy5wcm9maWxlX2xvY2F0aW9uLA0KICAgICAgICBiaXJ0aF9kYXRlOiB0aGlzLnByb2ZpbGVfYmlydGhfZGF0ZQ0KICAgICAgfSkudGhlbihwcm9maWxlX2RhdGEgPT4gew0KICAgICAgICAvL3JlZGlyZWN0IHJvdXRlciB0byB0aGUgZXZlbnQgZGVzY3JpcHRpb24NCiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goew0KICAgICAgICAgIG5hbWU6ICJ1c2VyLXByb2ZpbGUiLA0KICAgICAgICAgIHBhcmFtczogeyB1c2VyVXNlcm5hbWU6IHByb2ZpbGVfZGF0YS51c2VyIH0gLy9ldmVudCBqdXN0ICJQT1NURUQiDQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgfQ0KICB9LA0KDQogIGNyZWF0ZWQoKSB7DQogICAgZG9jdW1lbnQudGl0bGUgPSAiRWRpdG9yIC0gRXZlbnRCdWRkeSI7DQogIH0NCn07DQo="},{"version":3,"sources":["ProfileEditor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+CA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"ProfileEditor.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"container mt-2\">\r\n    <div class=\"row\">\r\n      <div class=\"col-12\">\r\n        <h1 class=\"mb-3\">{{userUsername}}: Modifica il tuo Profilo </h1>\r\n        <form @submit.prevent=\"onSubmit\">\r\n          <!--@ onSubmit.prevent = prevent the page to reload -->\r\n          <!--Picture Profile-->\r\n\r\n          <textarea\r\n            v-model=\"profile_bio\"\r\n            class=\"form-control\"\r\n            placeholder=\"Biografia\"\r\n            rows=\"4\"\r\n          >\r\n                    </textarea>\r\n          <textarea\r\n            v-model=\"profile_location\"\r\n            class=\"form-control\"\r\n            placeholder=\"CittÃ \"\r\n            rows=\"1\"\r\n          >\r\n                    </textarea>\r\n          <div class=\"date-control\">\r\n            <p>Data nascita</p>\r\n            <input\r\n              type=\"date\"\r\n              id=\"profile-birth\"\r\n              name=\"profile-birth\"\r\n              v-model=\"profile_birth_date\"\r\n              value=\"\"\r\n            >\r\n          </div>\r\n          <br>\r\n          <button\r\n            class=\"btn btn-success\"\r\n            type=\"submit\"\r\n          >Aggiorna Profilo\r\n          </button>\r\n        </form>\r\n        <p class=\"error mt-2\">{{ error }}</p>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { apiService } from \"../common/api.service\";\r\n\r\nexport default {\r\n  name: \"ProfileEditor\",\r\n\r\n  props: {\r\n    userUsername: {\r\n      type: String,\r\n      required: true\r\n    },\r\n    previousProfile: {\r\n      type: String,\r\n      required: false\r\n    }\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      //  profile_avatar: this.previousProfile || null,\r\n      profile_bio: this.previousProfile || null,\r\n      profile_location: this.previousProfile || null,\r\n      profile_birth_date: this.previousProfile || null,\r\n      error: null\r\n    };\r\n  },\r\n  //to fill the fields at onPageLoad??\r\n  async beforeRouteEnter(to, from, next) {\r\n    if (to.params.userUsername !== undefined) {\r\n      let endpoint = `/api/profiles/${to.params.userUsername}/`;\r\n      await apiService(endpoint).then(data => {\r\n        to.params.previousProfile = data.content;\r\n      });\r\n    }\r\n    return next();\r\n  },\r\n\r\n  methods: {\r\n    onSubmit() {\r\n      //POST in the API/profiles/\r\n      let endpoint = `/api/profiles/${this.userUsername}/`;\r\n      let method = \"PUT\";\r\n      //if (this.previousProfile) {\r\n      //  method = \"PUT\";\r\n      //  endpoint += `${this.userUsername}/`;\r\n      //} //call the service for the POST request and then..\r\n      apiService(endpoint, method, {\r\n        //avatar: this.profile_avatar,\r\n        bio: this.profile_bio,\r\n        location: this.profile_location,\r\n        birth_date: this.profile_birth_date\r\n      }).then(profile_data => {\r\n        //redirect router to the event description\r\n        this.$router.push({\r\n          name: \"user-profile\",\r\n          params: { userUsername: profile_data.user } //event just \"POSTED\"\r\n        });\r\n      });\r\n    }\r\n  },\r\n\r\n  created() {\r\n    document.title = \"Editor - EventBuddy\";\r\n  }\r\n};\r\n</script>\r\n"]}]}